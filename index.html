<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Smart Price Editor</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root { --sk: #ff4b5c; --kt: #20c997; --lg: #f06595; --main: #4c6ef5; --bg: #f8f9fa; }
        body { font-family: 'Pretendard', -apple-system, sans-serif; background: var(--bg); margin: 0; display: flex; flex-direction: column; align-items: center; padding: 40px 20px; color: #343a40; }
        
        /* ìƒë‹¨ íƒ­ ë©”ë‰´ */
        .tab-menu { display: flex; gap: 10px; margin-bottom: 30px; background: #fff; padding: 8px; border-radius: 50px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .tab-btn { border: none; padding: 12px 30px; border-radius: 50px; cursor: pointer; font-weight: bold; background: transparent; color: #868e96; transition: 0.3s; }
        .tab-btn.active { background: var(--main); color: #fff; box-shadow: 0 4px 10px rgba(76, 110, 245, 0.3); }

        /* ì—ë””í„° & í”„ë¦¬ë·° ì»¨í…Œì´ë„ˆ */
        .workspace { display: grid; grid-template-columns: 1fr 450px; gap: 40px; width: 100%; max-width: 1200px; }
        .panel { background: #fff; border-radius: 20px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.03); }

        /* ì—ë””í„° ìŠ¤íƒ€ì¼ */
        .row-item { display: grid; grid-template-columns: 1.5fr 1fr 1fr 40px; gap: 10px; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px dashed #eee; }
        input { border: 1.5px solid #edf2ff; padding: 10px; border-radius: 8px; outline: none; transition: 0.2s; font-size: 14px; }
        input:focus { border-color: var(--main); background: #f8faff; }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-left: 5px solid var(--main); padding-left: 15px; }

        /* í”„ë¦¬ë·° ìŠ¤íƒ€ì¼ (ì„¸ë ¨ë˜ê²Œ) */
        #capture-area { background: #fff; width: 400px; padding: 30px; border-radius: 10px; }
        .preview-card { border-radius: 15px; overflow: hidden; border: 1px solid #f1f3f5; box-shadow: 0 15px 35px rgba(0,0,0,0.05); }
        .card-header { background: var(--main); color: #fff; padding: 20px; text-align: center; }
        .card-header h2 { margin: 0; font-size: 20px; letter-spacing: -0.5px; }
        
        .type-tag { display: inline-block; padding: 4px 12px; border-radius: 4px; font-size: 11px; font-weight: bold; color: #fff; margin-bottom: 5px; }
        .tag-sk { background: var(--sk); } .tag-kt { background: var(--kt); } .tag-lg { background: var(--lg); }

        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        th { font-size: 11px; color: #adb5bd; padding: 8px; text-align: center; border-bottom: 1px solid #f1f3f5; }
        td { padding: 12px 8px; font-size: 14px; text-align: center; border-bottom: 1px solid #f8f9fa; }
        .m-name { text-align: left; font-weight: 600; color: #495057; }
        .m-price { font-weight: 800; color: #f03e3e; font-size: 16px; }

        .btn-add { background: #f1f3f5; color: #495057; border: none; padding: 6px 15px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; }
        .btn-save { grid-column: span 2; background: #212529; color: #fff; border: none; padding: 20px; border-radius: 15px; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 20px; }
    </style>
</head>
<body>

    <div class="tab-menu">
        <button class="tab-btn active" onclick="switchTab('mobile')">ğŸ“± í†µì‹ ì‚¬ë³„ ìƒì„¸</button>
        <button class="tab-btn" onclick="switchTab('compare')">ğŸ“Š 3ì‚¬ ë¹„êµ ì‹œì„¸</button>
    </div>

    <div class="workspace">
        <div class="panel" id="editor-side">
            </div>

        <div class="preview-container">
            <div id="capture-area">
                <div class="preview-card">
                    <div class="card-header">
                        <span style="font-size: 12px; opacity: 0.8;">DAILY PRICE</span>
                        <h2 id="view-title">í†µì‹ ì‚¬ë³„ ìƒì„¸ ì‹œì„¸í‘œ</h2>
                    </div>
                    <div id="preview-content" style="padding: 10px 20px;">
                        </div>
                </div>
            </div>
        </div>

        <button class="btn-save" onclick="saveImage()">ğŸ“¸ í˜„ì¬ í™”ë©´ ì´ë¯¸ì§€ ì €ì¥</button>
    </div>

<script>
    let currentTab = 'mobile';
    let mobileData = [
        { brand: 'SKT', color: 'sk', rows: [{n:'ì•„ì´í° 15', b:'10', g:'15'}] },
        { brand: 'KT', color: 'kt', rows: [{n:'ê°¤ëŸ­ì‹œ S24', b:'5', g:'10'}] }
    ];
    let compareData = [
        { name: 'ğŸ”¥ í”„ë¦¬ë¯¸ì—„ ëª¨ë¸', rows: [{n:'S24 Ultra', sk:'40', kt:'38', lg:'35'}] }
    ];

    function switchTab(tab) {
        currentTab = tab;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');
        render();
    }

    function render() {
        const editor = document.getElementById('editor-side');
        const preview = document.getElementById('preview-content');
        const title = document.getElementById('view-title');
        editor.innerHTML = ''; preview.innerHTML = '';

        if(currentTab === 'mobile') {
            title.innerText = "í†µì‹ ì‚¬ë³„ ìƒì„¸ ì‹œì„¸í‘œ";
            mobileData.forEach((sec, sIdx) => {
                // ì—ë””í„° UI
                let html = `<div class="section-header"><strong>${sec.brand}</strong> <button class="btn-add" onclick="addRow(${sIdx})">+ ì¶”ê°€</button></div>`;
                sec.rows.forEach((r, rIdx) => {
                    html += `<div class="row-item">
                        <input type="text" value="${r.n}" oninput="update(${sIdx},${rIdx},'n',this.value)" placeholder="ëª¨ë¸">
                        <input type="text" value="${r.b}" oninput="update(${sIdx},${rIdx},'b',this.value)" placeholder="ë²ˆì´">
                        <input type="text" value="${r.g}" oninput="update(${sIdx},${rIdx},'g',this.value)" placeholder="ê¸°ë³€">
                        <button onclick="delRow(${sIdx},${rIdx})" style="border:none;background:none;color:#ff6b6b;cursor:pointer">âœ•</button>
                    </div>`;
                });
                editor.innerHTML += `<div style="margin-bottom:30px">${html}</div>`;

                // í”„ë¦¬ë·° UI
                let tableHtml = `<div class="type-tag tag-${sec.color}">${sec.brand}</div>
                    <table><tr><th>ëª¨ë¸ëª…</th><th>ë²ˆì´</th><th>ê¸°ë³€</th></tr>`;
                sec.rows.forEach(r => {
                    tableHtml += `<tr><td class="m-name">${r.n||'-'}</td><td class="m-price">${r.b||'-'}</td><td class="m-price">${r.g||'-'}</td></tr>`;
                });
                preview.innerHTML += tableHtml + `</table>`;
            });
        } else {
            title.innerText = "3ì‚¬ í†µí•© ë¹„êµí‘œ";
            compareData.forEach((sec, sIdx) => {
                let html = `<div class="section-header"><strong>${sec.name}</strong> <button class="btn-add" onclick="addRow(${sIdx})">+ ì¶”ê°€</button></div>`;
                sec.rows.forEach((r, rIdx) => {
                    html += `<div style="display:grid;grid-template-columns:1.5fr 1fr 1fr 1fr 40px;gap:10px;margin-bottom:10px;">
                        <input type="text" value="${r.n}" oninput="update(${sIdx},${rIdx},'n',this.value)">
                        <input type="text" value="${r.sk}" oninput="update(${sIdx},${rIdx},'sk',this.value)" placeholder="SK">
                        <input type="text" value="${r.kt}" oninput="update(${sIdx},${rIdx},'kt',this.value)" placeholder="KT">
                        <input type="text" value="${r.lg}" oninput="update(${sIdx},${rIdx},'lg',this.value)" placeholder="LG">
                        <button onclick="delRow(${sIdx},${rIdx})" style="border:none;background:none;color:#ff6b6b;cursor:pointer">âœ•</button>
                    </div>`;
                });
                editor.innerHTML += html;

                let tableHtml = `<div style="font-weight:bold; font-size:14px; margin-top:15px; color:var(--main)"># ${sec.name}</div>
                    <table><tr><th>ëª¨ë¸</th><th style="color:var(--sk)">SK</th><th style="color:var(--kt)">KT</th><th style="color:var(--lg)">LG</th></tr>`;
                sec.rows.forEach(r => {
                    tableHtml += `<tr><td class="m-name">${r.n||'-'}</td><td class="m-price">${r.sk||'-'}</td><td class="m-price">${r.kt||'-'}</td><td class="m-price">${r.lg||'-'}</td></tr>`;
                });
                preview.innerHTML += tableHtml + `</table>`;
            });
        }
    }

    function addRow(sIdx) {
        if(currentTab === 'mobile') mobileData[sIdx].rows.push({n:'', b:'', g:''});
        else compareData[sIdx].rows.push({n:'', sk:'', kt:'', lg:''});
        render();
    }
    function delRow(sIdx, rIdx) {
        if(currentTab === 'mobile') mobileData[sIdx].rows.splice(rIdx, 1);
        else compareData[sIdx].rows.splice(rIdx, 1);
        render();
    }
    function update(sIdx, rIdx, k, v) {
        if(currentTab === 'mobile') mobileData[sIdx].rows[rIdx][k] = v;
        else compareData[sIdx].rows[rIdx][k] = v;
        render();
    }
    function saveImage() {
        html2canvas(document.querySelector("#capture-area"), {scale:3, backgroundColor:null}).then(canvas => {
            const a = document.createElement('a');
            a.download = `PriceTable_${new Date().getTime()}.png`;
            a.href = canvas.toDataURL();
            a.click();
        });
    }
    render();
</script>
</body>
</html>
