<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Premium ì„±ì§€ ì‹œì„¸í‘œ ì—ë””í„°</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root { --primary: #4f46e5; --bg: #f1f5f9; --card: #ffffff; --danger: #ef4444; }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); display: flex; justify-content: center; padding: 20px; gap: 20px; color: #334155; }
        
        /* ì™¼ìª½ ì—ë””í„° */
        .editor-container { width: 550px; background: var(--card); padding: 25px; border-radius: 12px; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
        .config-box { background: #eef2ff; padding: 15px; border-radius: 8px; margin-bottom: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .config-box div { display: flex; flex-direction: column; gap: 5px; font-size: 13px; font-weight: bold; }
        
        .category-box { border: 1px solid #e2e8f0; padding: 15px; border-radius: 8px; margin-bottom: 20px; background: #fafafa; }
        .category-title { font-weight: bold; margin-bottom: 12px; color: var(--primary); display: flex; justify-content: space-between; align-items: center; }
        
        .input-row { display: grid; gap: 8px; margin-bottom: 8px; align-items: center; background: #fff; padding: 5px; border-radius: 4px; border: 1px solid #eee; }
        .row-mobile { grid-template-columns: 1.5fr 1fr 1fr 45px; }
        .row-internet { grid-template-columns: 1.5fr 1.5fr 0.5fr 45px; }
        
        input { padding: 8px; border: 1px solid #cbd5e1; border-radius: 4px; font-size: 13px; width: 100%; box-sizing: border-box; }
        input:focus { border-color: var(--primary); outline: none; }
        
        /* ì˜¤ë¥¸ìª½ ë¯¸ë¦¬ë³´ê¸° */
        .preview-container { position: sticky; top: 20px; }
        #capture-area { background: #fff; width: 420px; padding: 25px; border: 1px solid #333; }
        
        .shop-info { text-align: center; margin-bottom: 15px; }
        #viewShopName { font-size: 24px; font-weight: 900; color: var(--primary); margin-bottom: 5px; }
        #viewContact { font-size: 13px; color: #64748b; }
        
        .main-header { background: #333; color: #fff; text-align: center; padding: 10px; font-size: 16px; font-weight: bold; margin-bottom: 15px; border-radius: 4px; }
        
        .section-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; table-layout: fixed; }
        .section-table th { background: #f8fafc; border: 1px solid #ccc; padding: 8px; font-size: 12px; color: #475569; }
        .section-table td { border: 1px solid #ccc; padding: 10px; text-align: center; font-size: 14px; word-break: break-all; }
        .cat-header { background: var(--primary) !important; color: white !important; font-weight: bold; font-size: 14px; letter-spacing: 1px; }
        .price-text { color: #e11d48; font-weight: 800; }

        /* ë²„íŠ¼ */
        .btn { cursor: pointer; border: none; border-radius: 6px; font-weight: bold; transition: 0.2s; }
        .btn-add { background: #10b981; color: white; padding: 6px 12px; font-size: 12px; }
        .btn-del { background: var(--danger); color: white; height: 32px; font-size: 11px; }
        .btn-save { background: #1e293b; color: white; width: 100%; padding: 18px; font-size: 18px; margin-top: 10px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn:hover { opacity: 0.8; transform: translateY(-1px); }
    </style>
</head>
<body>

<div class="editor-container">
    <h2 style="margin:0 0 20px 0;">ğŸ› ï¸ ì‹œì„¸í‘œ ë§ˆìŠ¤í„° ì—ë””í„°</h2>
    
    <div class="config-box">
        <div>
            ë§¤ì¥ ëª…ì¹­ <input type="text" id="shopNameInput" value="ìš°ë¦¬ë™ë„¤ ì„±ì§€" oninput="renderTable()">
        </div>
        <div>
            ë¬¸ì˜ì²˜ (ì¹´í†¡ ë“±) <input type="text" id="contactInput" value="ì¹´í†¡: @ì„±ì§€ì¹œêµ¬" oninput="renderTable()">
        </div>
        <div>
            ê¸°ì¤€ ë‚ ì§œ <input type="text" id="dateInput" value="2026-01-29" oninput="renderTable()">
        </div>
    </div>

    <div id="editor-fields"></div>

    <button class="btn btn-save" onclick="saveImage()">ğŸ“¸ ì´ë¯¸ì§€ë¡œ ì €ì¥í•˜ê¸°</button>
</div>

<div class="preview-container">
    <div id="capture-area">
        <div class="shop-info">
            <div id="viewShopName">ìš°ë¦¬ë™ë„¤ ì„±ì§€</div>
            <div id="viewContact">ì¹´í†¡: @ì„±ì§€ì¹œêµ¬</div>
        </div>
        <div class="main-header">ğŸ“¢ ë‹¨ê°€ ì‹œì„¸í‘œ (<span id="viewDate">2026-01-29</span>)</div>
        <div id="table-render-zone"></div>
        <p style="font-size:11px; color:#94a3b8; text-align:center; margin-top: 10px;">â€» ìœ„ ë‹¨ê°€ëŠ” ì‹¤ì‹œê°„ ë³€ë™ë  ìˆ˜ ìˆìœ¼ë©°, ì¬ê³  í™•ì¸ í•„ìˆ˜ì…ë‹ˆë‹¤.</p>
    </div>
</div>

<script>
    const categories = [
        { id: 'galaxy', name: 'âœ¨ GALAXY (ì‚¼ì„±)', type: 'mobile', rows: [{v1:'ê°¤ëŸ­ì‹œ S24', v2:'0', v3:'10'}] },
        { id: 'iphone', name: 'ğŸ IPHONE (ì• í”Œ)', type: 'mobile', rows: [{v1:'ì•„ì´í° 15 Pro', v2:'35', v3:'40'}] },
        { id: 'kids', name: 'ğŸ‘¶ í‚¤ì¦ˆí°/íš¨ë„í°', type: 'mobile', rows: [{v1:'ì‹œë‚˜ëª¨ë¡¤í° 2', v2:'ê³µì§œ', v3:'ê³µì§œ'}] },
        { id: 'internet', name: 'ğŸŒ ì¸í„°ë„· + TV ê²°í•©', type: 'internet', rows: [{v1:'SK 500M+TV', v2:'ìµœëŒ€ ì§€ì›', v3:'3ë…„ì•½ì •'}] }
    ];

    function initEditor() {
        const container = document.getElementById('editor-fields');
        container.innerHTML = '';
        categories.forEach((cat, catIdx) => {
            const isInt = cat.type === 'internet';
            const box = document.createElement('div');
            box.className = 'category-box';
            box.innerHTML = `
                <div class="category-title">
                    <span>${cat.name}</span>
                    <button class="btn btn-add" onclick="addRow(${catIdx})">+ ì¤„ ì¶”ê°€</button>
                </div>
                <div id="cat-rows-${catIdx}">
                    ${cat.rows.map((row, rowIdx) => `
                        <div class="input-row ${isInt ? 'row-internet' : 'row-mobile'}">
                            <input type="text" placeholder="${isInt ? 'ìƒí’ˆëª…' : 'ëª¨ë¸ëª…'}" value="${row.v1}" oninput="updateData(${catIdx}, ${rowIdx}, 'v1', this.value)">
                            <input type="text" placeholder="${isInt ? 'ì§€ì›ê¸ˆ' : 'ë²ˆì´'}" value="${row.v2}" oninput="updateData(${catIdx}, ${rowIdx}, 'v2', this.value)">
                            <input type="text" placeholder="${isInt ? 'ë¹„ê³ ' : 'ê¸°ë³€'}" value="${row.v3}" oninput="updateData(${catIdx}, ${rowIdx}, 'v3', this.value)">
                            <button class="btn btn-del" onclick="delRow(${catIdx}, ${rowIdx})">ì‚­ì œ</button>
                        </div>
                    `).join('')}
                </div>
            `;
            container.appendChild(box);
        });
        renderTable();
    }

    function addRow(catIdx) {
        categories[catIdx].rows.push({v1:'', v2:'', v3:''});
        initEditor();
    }

    function delRow(catIdx, rowIdx) {
        categories[catIdx].rows.splice(rowIdx, 1);
        initEditor();
    }

    function updateData(catIdx, rowIdx, field, val) {
        categories[catIdx].rows[rowIdx][field] = val;
        renderTable();
    }

    function renderTable() {
        document.getElementById('viewShopName').innerText = document.getElementById('shopNameInput').value;
        document.getElementById('viewContact').innerText = document.getElementById('contactInput').value;
        document.getElementById('viewDate').innerText = document.getElementById('dateInput').value;
        
        const zone = document.getElementById('table-render-zone');
        zone.innerHTML = '';

        categories.forEach(cat => {
            if(cat.rows.length === 0) return;
            const isInt = cat.type === 'internet';
            let html = `<table class="section-table">
                <thead>
                    <tr><th colspan="3" class="cat-header">${cat.name}</th></tr>
                    <tr><th width="45%">${isInt ? 'ìƒí’ˆëª…' : 'ëª¨ë¸ëª…'}</th><th width="27.5%">${isInt ? 'í˜„ê¸ˆì§€ì›' : 'ë²ˆí˜¸ì´ë™'}</th><th width="27.5%">${isInt ? 'ë¹„ê³ ' : 'ê¸°ê¸°ë³€ê²½'}</th></tr>
                </thead>
                <tbody>`;
            cat.rows.forEach(row => {
                html += `<tr>
                    <td style="text-align:left; font-weight:600;">${row.v1 || '-'}</td>
                    <td class="price-text">${row.v2 || '-'}</td>
                    <td class="${isInt ? '' : 'price-text'}">${row.v3 || '-'}</td>
                </tr>`;
            });
            html += `</tbody></table>`;
            zone.innerHTML += html;
        });
    }

    function saveImage() {
        const area = document.getElementById('capture-area');
        // ì €ì¥ ì‹œ ê³ í™”ì§ˆì„ ìœ„í•´ scale ì˜µì…˜ ì¶”ê°€
        html2canvas(area, { scale: 3, useCORS: true }).then(canvas => {
            const link = document.createElement('a');
            link.download = `${document.getElementById('shopNameInput').value}_ì‹œì„¸í‘œ.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
        });
    }

    initEditor();
</script>
</body>
</html>
