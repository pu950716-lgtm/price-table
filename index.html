<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì¢…í•© ì§€ì›ê¸ˆ ì‹œì„¸í‘œ ì—ë””í„°</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root { --primary: #4f46e5; --bg: #f1f5f9; --card: #ffffff; }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); display: flex; justify-content: center; padding: 20px; gap: 20px; }
        
        /* ì™¼ìª½ ì—ë””í„° */
        .editor-container { width: 500px; background: var(--card); padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); height: fit-content; }
        .category-box { border: 1px solid #e2e8f0; padding: 15px; border-radius: 8px; margin-bottom: 20px; background: #fafafa; }
        .category-title { font-weight: bold; margin-bottom: 10px; color: var(--primary); display: flex; justify-content: space-between; }
        .input-row { display: grid; grid-template-columns: 2fr 1fr 1fr 40px; gap: 5px; margin-bottom: 5px; }
        input { padding: 6px; border: 1px solid #cbd5e1; border-radius: 4px; font-size: 12px; }
        
        /* ì˜¤ë¥¸ìª½ ë¯¸ë¦¬ë³´ê¸° */
        .preview-container { position: sticky; top: 20px; }
        #capture-area { background: #fff; width: 400px; padding: 15px; border: 1px solid #000; }
        .main-header { background: #333; color: #fff; text-align: center; padding: 10px; font-size: 18px; font-weight: bold; margin-bottom: 10px; }
        
        .section-table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
        .section-table th { background: #f1f5f9; border: 1px solid #ccc; padding: 5px; font-size: 12px; }
        .section-table td { border: 1px solid #ccc; padding: 7px; text-align: center; font-size: 13px; }
        .cat-header { background: #4f46e5 !important; color: white !important; font-weight: bold; }
        .price-text { color: #e11d48; font-weight: bold; }

        .btn { cursor: pointer; border: none; border-radius: 4px; padding: 5px 10px; font-size: 12px; font-weight: bold; }
        .btn-add { background: #10b981; color: white; }
        .btn-del { background: #ef4444; color: white; }
        .btn-save { background: #333; color: white; width: 100%; padding: 15px; font-size: 16px; margin-top: 10px; border-radius: 8px; }
    </style>
</head>
<body>

<div class="editor-container">
    <h2 style="margin-top:0">ğŸ“‘ ì‹œì„¸í‘œ ìƒì„¸ í¸ì§‘</h2>
    <div style="margin-bottom:20px;">
        ë‚ ì§œ ì…ë ¥: <input type="text" id="dateInput" value="2026-01-29" oninput="renderTable()" style="width:120px">
    </div>

    <div id="editor-fields"></div>

    <button class="btn btn-save" onclick="saveImage()">ğŸ“¸ ì´ë¯¸ì§€ë¡œ ì €ì¥í•˜ê¸°</button>
</div>

<div class="preview-container">
    <div id="capture-area">
        <div class="main-header">ğŸ“± ì„±ì§€ í†µí•© ì‹œì„¸í‘œ (<span id="viewDate">2026-01-29</span>)</div>
        <div id="table-render-zone"></div>
        <p style="font-size:10px; color:gray; text-align:center">â€» ìœ„ ì‹œì„¸ëŠ” í• ë¶€ì›ê¸ˆ ê¸°ì¤€ì´ë©° ë³€ë™ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </div>
</div>

<script>
    // ë°ì´í„° êµ¬ì¡°
    const categories = [
        { id: 'galaxy', name: 'âœ¨ GALAXY (ì‚¼ì„±)', rows: [{name:'', m1:'', m2:''}] },
        { id: 'iphone', name: 'ğŸ IPHONE (ì• í”Œ)', rows: [{name:'', m1:'', m2:''}] },
        { id: 'kids', name: 'ğŸ‘¶ í‚¤ì¦ˆí°/íš¨ë„í°', rows: [{name:'', m1:'', m2:''}] },
        { id: 'internet', name: 'ğŸŒ ì¸í„°ë„· + TV ê²°í•©', rows: [{name:'', m1:'', m2:''}] }
    ];

    // ì—ë””í„° UI ê·¸ë¦¬ê¸°
    function initEditor() {
        const container = document.getElementById('editor-fields');
        container.innerHTML = '';

        categories.forEach((cat, catIdx) => {
            const box = document.createElement('div');
            box.className = 'category-box';
            box.innerHTML = `
                <div class="category-title">
                    <span>${cat.name}</span>
                    <button class="btn btn-add" onclick="addRow(${catIdx})">+ ì¶”ê°€</button>
                </div>
                <div id="cat-rows-${catIdx}">
                    ${cat.rows.map((row, rowIdx) => `
                        <div class="input-row">
                            <input type="text" placeholder="ëª¨ë¸ëª…" value="${row.name}" oninput="updateData(${catIdx}, ${rowIdx}, 'name', this.value)">
                            <input type="text" placeholder="ë²ˆì´" value="${row.m1}" oninput="updateData(${catIdx}, ${rowIdx}, 'm1', this.value)">
                            <input type="text" placeholder="ê¸°ë³€" value="${row.m2}" oninput="updateData(${catIdx}, ${rowIdx}, 'm2', this.value)">
                            <button class="btn btn-del" onclick="delRow(${catIdx}, ${rowIdx})">X</button>
                        </div>
                    `).join('')}
                </div>
            `;
            container.appendChild(box);
        });
        renderTable();
    }

    function addRow(catIdx) {
        categories[catIdx].rows.push({name:'', m1:'', m2:''});
        initEditor();
    }

    function delRow(catIdx, rowIdx) {
        categories[catIdx].rows.splice(rowIdx, 1);
        initEditor();
    }

    function updateData(catIdx, rowIdx, field, val) {
        categories[catIdx].rows[rowIdx][field] = val;
        renderTable();
    }

    // ì˜¤ë¥¸ìª½ ë¯¸ë¦¬ë³´ê¸° í…Œì´ë¸” ê·¸ë¦¬ê¸°
    function renderTable() {
        document.getElementById('viewDate').innerText = document.getElementById('dateInput').value;
        const zone = document.getElementById('table-render-zone');
        zone.innerHTML = '';

        categories.forEach(cat => {
            if(cat.rows.length === 0) return;

            let html = `<table class="section-table">
                <thead>
                    <tr><th colspan="3" class="cat-header">${cat.name}</th></tr>
                    <tr><th width="40%">ëª¨ë¸ëª…</th><th width="30%">ë²ˆí˜¸ì´ë™</th><th width="30%">ê¸°ê¸°ë³€ê²½</th></tr>
                </thead>
                <tbody>`;
            
            cat.rows.forEach(row => {
                html += `<tr>
                    <td style="text-align:left; padding-left:10px;">${row.name || '-'}</td>
                    <td class="price-text">${row.m1 || '-'}</td>
                    <td class="price-text">${row.m2 || '-'}</td>
                </tr>`;
            });

            html += `</tbody></table>`;
            zone.innerHTML += html;
        });
    }

    function saveImage() {
        const area = document.getElementById('capture-area');
        html2canvas(area).then(canvas => {
            const link = document.createElement('a');
            link.download = `ì‹œì„¸í‘œ_${document.getElementById('dateInput').value}.png`;
            link.href = canvas.toDataURL();
            link.click();
        });
    }

    initEditor();
</script>

</body>
</html>
